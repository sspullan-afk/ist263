<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Portfolio - leaderboard</title>
  <meta name="viewport" content="width=device-width">
  <link rel = 'stylesheet' href='styles.css'>
  <link rel="shortcut icon" type="image/x-icon" href="p_images/favicon.ico">
</head>
<body>
  <nav class="site-nav" aria-label="Primary">
    <a class="skip-link" href="#main-content">Skip to main content</a>
    <a class="brand" href="home.html">Ski Activity Tracker</a>
    <button class="nav-toggle" type="button"
      aria-expanded="false" aria-controls="nav-links">
      <span class="sr-only">Open navigation menu</span>
      &#9776;
    </button>

    <div id="nav-links" class="nav-links">
      <a href="home.html">Home</a>
      <a href="stats.html">Stats</a>
      <a href="leaderboard.html">Leaderboard</a>
    </div>
  </nav>

  <main id="main-content" class="page">
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const tbody = document.getElementById('leaderboard-body');

        const fakeEntries = [
          {
            name: "Alex",
            conditions: "powder",
            maxSpeed: 56.3,
            runs: 14,
            vertical: 14500,
            timeSkiing: "04:12",
            distance: 27.1
          },
          {
            name: "Sophia",
            conditions: "groomed",
            maxSpeed: 61.7,
            runs: 11,
            vertical: 12500,
            timeSkiing: "03:48",
            distance: 22.5
          },
          {
            name: "Jake",
            conditions: "icy",
            maxSpeed: 53.1,
            runs: 16,
            vertical: 16200,
            timeSkiing: "05:06",
            distance: 29.3
          }
        ];

        function addRow(entry) {
          const tr = document.createElement('tr');
          tr.innerHTML = `
            <td>${entry.name || "Anonymous"}</td>
            <td>${entry.conditions || ""}</td>
            <td>${Number(entry.maxSpeed ?? "").toString()}</td>
            <td>${Number.isFinite(entry.runs) ? entry.runs : ""}</td>
            <td>${Number.isFinite(entry.vertical) ? entry.vertical : ""}</td>
            <td>${entry.timeSkiing || ""}</td>
            <td>${Number(entry.distance ?? "").toString()}</td>
          `;
          tbody.appendChild(tr);
        }

        function getBestEntry(entries) {
          if (!entries.length) return null;
          return entries.reduce((best, cur) => {
            const bestVert = Number(best.vertical) || 0;
            const curVert  = Number(cur.vertical)  || 0;
            return curVert > bestVert ? cur : best;
          });
        }

        function loadLeaderboard() {
          tbody.innerHTML = "";

          fakeEntries.forEach(addRow);

          const entryKeys = Object.keys(localStorage)
            .filter(k => k.startsWith("skiEntries_"));

          entryKeys.forEach(key => {
            const entries = JSON.parse(localStorage.getItem(key) || "[]");
            const best = getBestEntry(entries);
            if (best) addRow(best);
          });
        }

        loadLeaderboard();
      });

      document.addEventListener("DOMContentLoaded", () => {
        const toggle = document.querySelector(".nav-toggle");
        const links = document.querySelector("#nav-links");

        if (!toggle || !links) return;

        toggle.addEventListener("click", () => {
          const isOpen = toggle.getAttribute("aria-expanded") === "true";
          toggle.setAttribute("aria-expanded", String(!isOpen));
          links.classList.toggle("show");
        });

        document.addEventListener("click", (e) => {
          if (!links.contains(e.target) && !toggle.contains(e.target)) {
            links.classList.remove("show");
            toggle.setAttribute("aria-expanded", "false");
          }
        });
      });
    </script>




    <header class="montserrat"><h1>Ski Day Leaderboard</h1></header>
    <p class="montserrat">Compare your ski day with others. Entries you submit on the Stats page will appear here automatically.</p>
    <section class="card leaderboard-wrap">
      <table id="leaderboard" class="montserrat">
        <thead>
          <tr>
            <th>Name</th>
            <th>Conditions</th>
            <th>Max Speed (mph)</th>
            <th>Runs</th>
            <th>Vertical (ft)</th>
            <th>Time (HH:MM)</th>
            <th>Distance (mi)</th>
          </tr>
        </thead>
        <tbody id="leaderboard-body"></tbody>
      </table>
    </section>
    <div class="hero-media">
      <img src="p_images/leaderboardone.jpg" alt="Ski racer making a sharp turn" width = '200'>
      <img src="p_images/leaderboard2.jpg" alt="downhill skier making a sharp turn" width = '200'>
    </div>
  </main>
</body>
</html>
